{"version":3,"sources":["validateUserDetails.js"],"names":["validateUserSignUpDetails","userDetails","schema","firstName","Joi","string","regex","error","Error","lastName","email","password","trim","min","required","validate","validateUserSignInDetails","signup","req","res","done","body","status","json","details","message","replace","login"],"mappings":"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","sourceRoot":"C:\\Users\\Blessing Abobo\\EPIC-Mail\\src\\Server\\middlewares","sourcesContent":["import Joi from 'joi';\r\n\r\nfunction validateUserSignUpDetails(userDetails) {\r\n  const schema = {\r\n    firstName: Joi.string()\r\n      .regex(/^[a-zA-Z]+$/)\r\n      .error(new Error('firstName is not valid')),\r\n\r\n    lastName: Joi.string()\r\n      .regex(/^[a-zA-Z]+$/)\r\n      .error(new Error('lastName is not valid')),\r\n\r\n    email: Joi.string().email()\r\n      .regex(/^[A-Za-z0-9_]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}$/)\r\n      .error(new Error('email is not valid')),\r\n    password: Joi.string().trim().min(6).required(),\r\n  };\r\n  return Joi.validate(userDetails, schema);\r\n}\r\n\r\nfunction validateUserSignInDetails(userDetails) {\r\n  const schema = {\r\n    email: Joi.string().email()\r\n      .regex(/^[A-Za-z0-9_]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}$/)\r\n      .error(new Error('email is not valid')),\r\n\r\n    password: Joi.string().min(6).required(),\r\n  };\r\n  return Joi.validate(userDetails, schema);\r\n}\r\n\r\nconst signup = (req, res, done) => {\r\n  const {\r\n    firstName, lastName, email, password,\r\n  } = req.body;\r\n  if (!firstName) {\r\n    return res.status(400).json({\r\n      status: 400,\r\n      error: 'firstName is required',\r\n    });\r\n  }\r\n  if (!lastName) {\r\n    return res.status(400).json({\r\n      status: 400,\r\n      error: 'lastName is required',\r\n    });\r\n  }\r\n  if (!email) {\r\n    return res.status(400).json({\r\n      status: 400,\r\n      error: 'email is required',\r\n    });\r\n  }\r\n  if (!password) {\r\n    return res.status(400).json({\r\n      status: 400,\r\n      error: 'password is required',\r\n    });\r\n  }\r\n  const { error } = validateUserSignUpDetails(req.body);\r\n  if (error) {\r\n    return res.status(400).json({\r\n      status: 400,\r\n      error: (error.details) ? error.details[0].message.replace(/[\"\"]+/g, '') : error.message,\r\n    });\r\n  }\r\n  return done();\r\n};\r\n\r\nconst login = (req, res, done) => {\r\n  const { email, password } = req.body;\r\n  if (!email) {\r\n    return res.status(400).json({\r\n      status: 400,\r\n      error: 'email is required',\r\n    });\r\n  }\r\n  if (!password) {\r\n    return res.status(400).json({\r\n      status: 400,\r\n      error: 'password is required',\r\n    });\r\n  }\r\n  const { error } = validateUserSignInDetails(req.body);\r\n  if (error) {\r\n    return res.status(400).json({\r\n      status: 400,\r\n      error: (error.details) ? error.details[0].message.replace(/[\"\"]+/g, '') : error.message,\r\n    });\r\n  }\r\n  return done();\r\n};\r\n\r\n\r\nexport { signup, login };\r\n"]}