{"version":3,"sources":["usersControllers.js"],"names":["UsersControllers","req","res","body","error","status","json","details","message","replace","getuser","users","find","userDetails","email","hashPassword","bcrypt","hashSync","password","payload","firstName","firstname","lastName","lastname","userToken","jwt","sign","expiresIn","user","id","length","authData","push","data","token","hashValue","compareSync"],"mappings":"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","sourceRoot":"C:\\Users\\Blessing Abobo\\EPIC-Mail\\src\\Server\\controllers","sourcesContent":["import bcrypt from 'bcrypt';\nimport jwt from 'jsonwebtoken';\nimport users from '../database/users';\nimport { validateUserSignUpDetails, validateUserSignInDetails } from '../middlewares/validateUserDetails';\n\n\nclass UsersControllers {\n// eslint-disable-next-line class-methods-use-this\n  static userSignUp(req, res) {\n    const { error } = validateUserSignUpDetails(req.body);\n    if (error) {\n      return res.status(400).json({\n        status: 400,\n        error: error.details[0].message.replace(/[\"\"]+/g, ''),\n      });\n    }\n    const getuser = users.find(userDetails => userDetails.email === req.body.email);\n    if (getuser) {\n      return res.status(409).json({\n        status: 409,\n        error: 'User already exists, Sign In!',\n      });\n    }\n    const hashPassword = bcrypt.hashSync(req.body.password, 10);\n    const payload = {\n      firstName: req.body.firstname,\n      lastName: req.body.lastname,\n      email: req.body.email,\n      password: hashPassword,\n    };\n    const userToken = jwt.sign(payload, 'secret', { expiresIn: 1440 });\n    const user = {\n      id: users.length + 1,\n      firstName: req.body.firstname,\n      lastName: req.body.lastname,\n      email: req.body.email,\n      password: hashPassword,\n      authData: userToken,\n    };\n    users.push(user);\n    return res.status(201).json({\n      status: 201,\n      data: [\n        {\n          token: userToken,\n        },\n      ],\n    });\n  }\n\n  static userSignIn(req, res) {\n    const { error } = validateUserSignInDetails(req.body);\n    if (error) {\n      return res.status(400).json({\n        status: 400,\n        error: error.details[0].message.replace(/[\"\"]+/g, ''),\n      });\n    }\n    const user = users.find(userDetails => userDetails.email === req.body.email);\n    if (!user) {\n      return res.status(404).json({\n        status: 404,\n        error: 'Details not found, Sign Up!',\n      });\n    }\n    const { authData, password } = user;\n    const hashValue = bcrypt.compareSync(req.body.password, password);\n    if (!hashValue) {\n      return res.status(401).json({\n        status: 401,\n        error: 'Incorrect password!',\n      });\n    }\n    return res.status(200).json({\n      status: 200,\n      data: [\n        {\n          token: authData,\n        },\n      ],\n    });\n  }\n}\n\n\nexport default UsersControllers;\n"]}