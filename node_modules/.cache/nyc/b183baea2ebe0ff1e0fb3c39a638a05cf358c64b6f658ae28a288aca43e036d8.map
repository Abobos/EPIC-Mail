{"version":3,"sources":["usersControllers.js"],"names":["UsersControllers","req","res","getuser","users","find","userDetails","email","body","status","json","error","hashPassword","bcrypt","hashSync","password","payload","firstName","lastName","userToken","jwt","sign","expiresIn","user","id","length","authData","push","data","token","hashValue","compareSync"],"mappings":"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","sourceRoot":"C:\\Users\\Blessing Abobo\\EPIC-Mail\\src\\Server\\controllers","sourcesContent":["import bcrypt from 'bcrypt';\r\nimport jwt from 'jsonwebtoken';\r\nimport users from '../database/users';\r\n\r\n\r\nclass UsersControllers {\r\n  static userSignUp(req, res) {\r\n    const getuser = users.find(userDetails => userDetails.email === req.body.email);\r\n    if (getuser) {\r\n      return res.status(409).json({\r\n        status: 409,\r\n        error: 'User already exists, Sign In!',\r\n      });\r\n    }\r\n    const hashPassword = bcrypt.hashSync(req.body.password, 10);\r\n    const payload = {\r\n      firstName: req.body.firstName,\r\n      lastName: req.body.lastName,\r\n      email: req.body.email,\r\n      password: hashPassword,\r\n    };\r\n    const userToken = jwt.sign(payload, 'secret', { expiresIn: 1440 });\r\n    const user = {\r\n      id: users.length + 1,\r\n      firstName: req.body.firstName,\r\n      lastName: req.body.lastName,\r\n      email: req.body.email,\r\n      password: hashPassword,\r\n      authData: userToken,\r\n    };\r\n    users.push(user);\r\n    return res.status(201).json({\r\n      status: 201,\r\n      data: [\r\n        {\r\n          token: userToken,\r\n        },\r\n      ],\r\n    });\r\n  }\r\n\r\n  static userSignIn(req, res) {\r\n    const user = users.find(userDetails => userDetails.email === req.body.email);\r\n    if (!user) {\r\n      return res.status(404).json({\r\n        status: 404,\r\n        error: 'Details not found, Sign Up!',\r\n      });\r\n    }\r\n    const { authData, password } = user;\r\n    const hashValue = bcrypt.compareSync(req.body.password, password);\r\n    if (!hashValue) {\r\n      return res.status(401).json({\r\n        status: 401,\r\n        error: 'Incorrect password!',\r\n      });\r\n    }\r\n    return res.status(200).json({\r\n      status: 200,\r\n      data: [\r\n        {\r\n          token: authData,\r\n        },\r\n      ],\r\n    });\r\n  }\r\n}\r\n\r\n\r\nexport default UsersControllers;\r\n"]}